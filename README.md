## 超级工程量提取 使用说明

### 工具简介
- 递归遍历当前目录及所有子目录，生成文件清单 `工程量.txt`。
- 输出按“目录 → 文件”结构组织，并具备以下规则：
  - 第一行：文件夹名；第二行：该目录中的第一个文件名（作为标题示例）。
  - 同一目录内的文件按扩展名排序（`dir /o:e`），相同格式（扩展名）连续排列。
  - 在同一目录内，遇到“文件格式变化”时，插入一条虚线 `----------------------------` 作为分隔。
  - 目录与目录之间使用两条虚线分隔。
  - 文件名缩进统一，标题示例行与下面列表保持一致缩进。

### 交互与显示
- 打开脚本后：
  - 屏幕为红色提示，显示大型 ASCII 签名与作者信息（黄色）。
  - 提示“按回车开始处理…”，按回车后开始提取。
- 完成后：
  - 以绿色显示“已提取完成，请在本 bat 文件同目录下查看: 工程量.txt”。
  - 提示“请按回车退出…”。

### 工作原理（简述）
- 进入脚本所在目录作为根目录。
- 根目录与每个子目录：
  - 找到该目录的第一个文件名，作为标题示例行（展示文件名形态，不代表全部内容）。
  - 使用 `dir /o:e` 获取文件清单并按扩展名排序。
  - 逐项输出文件名，当检测到扩展名变化时，插入一条虚线以分隔不同格式段落。
  - 目录与目录之间追加两条虚线，以清晰分隔目录块。
  - 所有文件名统一缩进，标题示例与列表对齐。

### 使用步骤
1. 将 `超级工程量提取.bat` 放到需要统计的根目录。
2. 双击运行，看到作者签名后，按回车开始处理。
3. 处理完成后，在同目录获得 `工程量.txt`。

### 环境要求
- Windows 10/11（已在经典 `cmd.exe` 下使用）。
- 默认启用 UTF-8（脚本内 `chcp 65001`），避免中文乱码。
- 建议命令行支持 ANSI 转义（脚本内已做处理），以正确显示彩色输出。

### 常见问题
- 文本颜色没按预期：某些终端禁用 ANSI 颜色，请在系统默认 `cmd` 中运行或检查第三方终端设置。
- 输出太长：可将结果重定向到其它文件名，或在文本编辑器中折叠查看。

### 自定义指引（可选）
- 修改分隔线样式：搜索 `----------------------------` 进行替换。
- 修改分组策略：当前按扩展名分组（变量 `lastExt`/`curExt` 逻辑），可改为按前缀、日期等。
- 修改标题示例：由“目录第一个文件”决定，位于“根目录/子目录标题生成”代码块内。

### 作者
- OSDEPK



